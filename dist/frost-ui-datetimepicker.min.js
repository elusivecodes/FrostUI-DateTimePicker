!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e:e(t)}(window,(function(t){"use strict";if(!t)throw new Error("FrostUI-DateTimePicker requires a Window.");if(!("UI"in t))throw new Error("FrostUI-DateTimePicker requires FrostUI.");if(!("DateTime"in t))throw new Error("FrostUI-DateTimePicker requires FrostDateTime.");const e=t.Core,a=t.dom,s=t.QuerySet,i=t.UI,n=t.DateTime,r=t.document;class d{constructor(t,s){if(this._node=t,this._settings=e.extend({},this.constructor.defaults,a.getDataset(this._node),s),this._hasDayPeriod=this.constructor.checkDayPeriod(this._settings.locale),this._settings.format||(this._settings.format=this.constructor.getDefaultFormat(this._settings.locale,this._hasDayPeriod)),this._dateOptions={locale:this._settings.locale,timeZone:this._settings.timeZone},this._settings.date)this._currentDate=this._parseDate(this._settings.date);else{const t=a.getValue(this._node);this._currentDate=this._parseDate(t)}this._currentDate||(this._currentDate=n.now(this._dateOptions)),this._settings.viewDate?this._viewDate=this._parseDate(this._settings.viewDate):this._currentDate&&(this._viewDate=this._currentDate.clone()),this._settings.minDate&&(this._minDate=this._parseDate(this._settings.minDate)),this._settings.maxDate&&(this._maxDate=this._parseDate(this._settings.maxDate)),this._settings.enabledDates?this._enabledDates=this._parseDates(this._settings.enabledDates):this._settings.disabledDates&&(this._disabledDates=this._parseDates(this._settings.disabledDates)),this._settings.enabledDays?this._enabledDays=this._settings.enabledDays:this._settings.disabledDays&&(this._disabledDays=this._settings.disabledDays),this._settings.enabledHours?this._enabledHours=this._settings.enabledHours:this._settings.disabledHours&&(this._disabledHours=this._settings.disabledHours),this._today=n.now(this._dateOptions),this._viewMode="month",this.update(),this._render(),this._events(),a.setData(this._node,"DateTimePicker",this)}destroy(){}hide(){}show(){}toggle(){}}Object.assign(d.prototype,{_events(){a.addEventDelegate([this._dateContainer,this._timeContainer],"click","[data-action]",t=>{const e=t.currentTarget;switch(a.getDataset(e,"action")){case"nextTime":this._currentDate.add(1,a.getDataset(e,"unit")),this.update(),this._renderView();break;case"prevTime":this._currentDate.sub(1,a.getDataset(e,"unit")),this.update(),this._renderView();break;case"dayPeriod":const t=this._currentDate.getHours();this._currentDate.setHours(t+(t<12?12:-12)),this.update(),this._renderView();break;case"next":this._viewDate.add(a.getDataset(e,"amount")||1,a.getDataset(e,"unit")),this._renderView();break;case"prev":this._viewDate.sub(a.getDataset(e,"amount")||1,a.getDataset(e,"unit")),this._renderView();break;case"changeView":this._viewMode=a.getDataset(e,"view"),a.hasAttribute(e,"data-year")&&this._viewDate.setYear(a.getDataset(e,"year"),a.getDataset(e,"month")||1,a.getDataset(e,"date")||1),this._renderView();break;case"setDate":this._currentDate.setYear(a.getDataset(e,"year"),a.getDataset(e,"month"),a.getDataset(e,"date")),this._viewDate=this._currentDate.clone(),this.update(),this._renderView()}})},_isDateValid(t){return(!this._minDate||!t.isBefore(this._minDate))&&((!this._maxDate||!t.isAfter(this._maxDate))&&((!this._disabledDates||!this._disabledDates.find(e=>e.isSame(t,"day")))&&(!(this._enabledDates&&!this._enabledDates.find(e=>e.isSame(t,"day")))&&((!this._disabledDays||!this._disabledDays.includes(t.getDay()))&&!(this._enabledDays&&!this._enabledDays.includes(t.getDay()))))))},_isMonthValid(t){return(!this._minDate||!t.isBefore(this._minDate,"month"))&&(!this._maxDate||!t.isAfter(this._maxDate,"month"))},_isYearValid(t){return(!this._minDate||!t.isBefore(this._minDate,"year"))&&(!this._maxDate||!t.isAfter(this._maxDate,"year"))},_isTimeValid(t){return!!this._isDateValid(t)&&((!this._disabledHours||!this._disabledHours.includes(t.getHour()))&&!(this._enabledHours&&!this._enabledHours.includes(t.getHour())))},_parseDate(t){if(!t)return t;if(t instanceof n)return n.fromTimestamp(t.getTimestamp(),this._dateOptions);if(e.isString(t))try{return n.fromFormat(this._settings.format,t,this._dateOptions)}catch(e){return new n(t,this._dateOptions)}return t instanceof Date?n.fromDate(t,this._dateOptions):e.isNumber(t)?n.fromTimestamp(t,this._dateOptions):e.isArray(t)?n.fromArray(t,this._dateOptions):null},_parseDates(t){return t.map(t=>this._parseDate(t)).filter(t=>!!t)}}),Object.assign(d.prototype,{refresh(){},_render(){this._dateContainer=a.create("div",{class:"datepicker"}),a.append(r.body,this._dateContainer),this._timeContainer=a.create("div",{class:"timepicker"}),a.append(r.body,this._timeContainer),this._renderView()},_renderView(){switch(a.empty(this._dateContainer),a.empty(this._timeContainer),this._viewMode){case"decade":this._renderDecade();break;case"year":this._renderYear();break;case"month":this._renderMonth()}this._renderTime()},_renderDecade(){const t=a.create("table",{class:"table table-sm text-center"}),e=this._viewDate.clone().startOf("year"),s=e.getYear(),i=s-s%10,n=i+9;e.setYear(i);const r=this._viewDate.clone().endOf("year").setYear(n),d=a.create("thead");a.append(t,d);const o=a.create("tr");a.append(d,o);const c=a.create("td",{html:'<span class="icon-arrow-left"></span>',class:"action text-primary fw-bold",dataset:{action:"prev",unit:"years",amount:10}});a.append(o,c);const h=a.create("td",{class:"change-view fw-bold",text:`${e.format("yyyy")} - ${r.format("yyyy")}`,attributes:{colspan:5}});a.append(o,h);const l=a.create("td",{html:'<span class="icon-arrow-right"></span>',class:"action text-primary fw-bold",dataset:{action:"next",unit:"years",amount:10}});a.append(o,l);const p=a.create("tbody");a.append(t,p);const _=a.create("tr");a.append(p,_);const u=a.create("td",{class:"p-0",attributes:{colspan:7}});a.append(_,u);const m=a.create("div",{class:"row"});for(a.append(u,m),e.sub(1,"year"),r.add(1,"year");e.isSameOrBefore(r,"month");){const t=e.getYear(),s=a.create("div",{text:e.format("yyyy"),class:"action col-4 p-1",dataset:{action:"changeView",view:"year",year:t}});a.append(m,s),this._currentDate.isSame(e,"year")&&a.addClass(s,"active"),this._isYearValid(e)||a.addClass(s,"disabled"),(t<i||t>n)&&a.addClass(s,"text-secondary"),e.add(1,"year")}a.append(this._dateContainer,t)},_renderMonth(){const t=a.create("table",{class:"table table-sm text-center"}),e=this._viewDate.clone().startOf("month").startOf("week"),s=this._viewDate.clone().endOf("month").endOf("week"),i=a.create("thead");a.append(t,i);const n=a.create("tr");a.append(i,n);const r=a.create("td",{html:'<span class="icon-arrow-left"></span>',class:"action text-primary fw-bold",dataset:{action:"prev",unit:"month"}});a.append(n,r);const d=a.create("td",{text:this._viewDate.format("MMMM yyyy"),class:"action fw-bold",attributes:{colspan:5},dataset:{action:"changeView",view:"year",year:e.getYear()}});a.append(n,d);const o=a.create("td",{html:'<span class="icon-arrow-right"></span>',class:"action text-primary fw-bold",dataset:{action:"next",unit:"month"}});a.append(n,o);const c=a.create("tr");a.append(i,c);const h=e.clone();for(let t=1;t<=7;t++){h.setWeekDay(t);const e=a.create("th",{class:"fw-bold",text:h.dayName("narrow")});a.append(c,e)}const l=a.create("tbody");let p;for(a.append(t,l);e.isSameOrBefore(s,"day");){1===e.getWeekDay()&&(p=a.create("tr"),a.append(l,p));const t=a.create("td",{text:e.format("dd"),class:"action",dataset:{action:"setDate",year:e.getYear(),month:e.getMonth(),date:e.getDate()}});a.append(p,t),this._currentDate.isSame(e,"day")&&a.addClass(t,"active"),this._today.isSame(e,"day")&&a.addClass(t,"today"),this._isDateValid(e)||a.addClass(t,"disabled"),this._viewDate.isSame(e,"month")||a.addClass(t,"text-secondary"),e.add(1,"day")}a.append(this._dateContainer,t)},_renderDay(){const t=a.create("table",{class:"table table-sm text-center"}),e=this._currentDate.clone().startOf("day"),s=this._currentDate.clone().endOf("day"),i=a.create("tbody");a.append(t,i);const n=a.create("tr");a.append(i,n);const r=a.create("td",{class:"p-0",attributes:{colspan:7}});for(a.append(n,r);e.isSameOrBefore(s,"hour");){const t=a.create("span",{text:e.format("HH"),class:"action",dataset:{action:"setHours",hour:e.getHours()}});a.append(r,t),this._isTimeValid(e)||a.addClass(t,"disabled"),e.add(1,"hour")}a.append(this._dateContainer,t)},_renderHour(){const t=a.create("table",{class:"table table-sm text-center"}),e=this._currentDate.clone().startOf("hour"),s=this._currentDate.clone().endOf("hour"),i=a.create("tbody");a.append(t,i);const n=a.create("tr");a.append(i,n);const r=a.create("td",{class:"p-0",attributes:{colspan:7}});for(a.append(n,r);e.isSameOrBefore(s,"minute");){const t=a.create("span",{text:e.format("HH"),class:"action",dataset:{action:"setMinutes",hour:e.getMinutes()}});a.append(r,t),this._isTimeValid(e)||a.addClass(t,"disabled"),e.add(1,"minute")}a.append(this._dateContainer,t)},_renderTime(){const t=a.create("table",{class:"table table-sm table-borderless text-center"}),e=a.create("tbody");a.append(t,e);const s=a.create("tr");a.append(e,s);const i=a.create("tr");a.append(e,i);const n=a.create("tr");a.append(e,n);const r=a.create("td",{html:'<span class="icon-arrow-up text-primary bw-bold"></span>',class:"action py-4 px-0",dataset:{action:"nextTime",unit:"hour"}});a.append(s,r);const d=a.create("td");a.append(s,d);const o=a.create("td",{html:'<span class="icon-arrow-up text-primary bw-bold"></span>',class:"action py-4 px-0",dataset:{action:"nextTime",unit:"minute"}});a.append(s,o);const c=a.create("td",{text:this._currentDate.format("hh"),class:"action time py-2 px-0",dataset:{action:"changeTimeView",timeView:"hours"}});a.append(i,c);const h=a.create("td",{text:":",class:"time py-2"});a.append(i,h);const l=a.create("td",{text:this._currentDate.format("mm"),class:"action time py-2 px-0",dataset:{action:"changeTimeView",timeView:"minutes"}});a.append(i,l);const p=a.create("td");a.append(i,p);const _=a.create("span",{text:this._currentDate.format("aa").toUpperCase(),class:"btn btn-primary d-block",dataset:{action:"dayPeriod"}});a.append(p,_);const u=a.create("td",{html:'<span class="icon-arrow-down text-primary bw-bold"></span>',class:"action py-4 px-0",dataset:{action:"prevTime",unit:"hour"}});a.append(n,u);const m=a.create("td");a.append(n,m);const D=a.create("td",{html:'<span class="icon-arrow-down text-primary bw-bold"></span>',class:"action py-4 px-0",dataset:{action:"prevTime",unit:"minute"}});a.append(n,D),a.append(this._timeContainer,t)},_renderYear(){const t=a.create("table",{class:"table table-sm text-center"}),e=this._viewDate.clone().startOf("year"),s=this._viewDate.clone().endOf("year"),i=a.create("thead");a.append(t,i);const n=a.create("tr");a.append(i,n);const r=a.create("td",{html:'<span class="icon-arrow-left"></span>',class:"action text-primary fw-bold",dataset:{action:"prev",unit:"year"}});a.append(n,r);const d=a.create("td",{text:this._viewDate.format("yyyy"),class:"action fw-bold",attributes:{colspan:5},dataset:{action:"changeView",view:"decade"}});a.append(n,d);const o=a.create("td",{html:'<span class="icon-arrow-right"></span>',class:"action text-primary fw-bold",dataset:{action:"next",unit:"year"}});a.append(n,o);const c=a.create("tbody");a.append(t,c);const h=a.create("tr");a.append(c,h);const l=a.create("td",{class:"p-0",attributes:{colspan:7}});a.append(h,l);const p=a.create("div",{class:"row"});for(a.append(l,p);e.isSameOrBefore(s,"month");){const t=a.create("div",{text:e.format("MMM"),class:"action col-4 p-1",dataset:{action:"changeView",view:"month",year:e.getYear(),month:e.getMonth()}});a.append(p,t),this._currentDate.isSame(e,"month")&&a.addClass(t,"active"),this._isMonthValid(e)||a.addClass(t,"disabled"),e.add(1,"month")}a.append(this._dateContainer,t)}}),Object.assign(d,{_dayPeriods:{},_defaultFormats:{},checkDayPeriod(t){if(!(t in this._dayPeriods)){const e=new Intl.DateTimeFormat(t,{hour:"2-digit"});this._dayPeriods[t]=e.formatToParts(new Date).find(t=>"dayPeriod"===t.type)}return this._dayPeriods[t]},getDefaultFormat(t,e){if(!(t in this._defaultFormats)){const a=new Intl.DateTimeFormat(t,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});this._defaultFormats[t]=a.formatToParts(new Date).map(t=>{switch(t.type){case"year":return"yyyy";case"month":return"MM";case"day":return"dd";case"hour":return e?"hh":"HH";case"minute":return"mm";case"second":return"ss";default:return", "===t.value?" ":`'${t.value}'`}}).join("")}return this._defaultFormats[t]}}),Object.assign(d.prototype,{disableDates(t){return this._disabledDates=this._parseDates(t),this._enabledDates=null,this.update(),this.refresh(),this},disableDays(t){return this._disabledDays=t,this._enabledDays=null,this.update(),this.refresh(),this},disableHours(t){return this._disabledHours=t,this._enabledHours=null,this.update(),this.refresh(),this},enableDates(t){return this._enabledDates=this._parseDates(t),this._disabledDates=null,this.update(),this.refresh(),this},enableDays(t){return this._enabledDays=t,this._disabledDays=null,this.update(),this.refresh(),this},enableHours(t){return this._enabledHours=t,this._disabledDays=null,this.update(),this.refresh(),this},maxDate(t){return this._maxDate=this._parseDate(t),this.update(),this.refresh(),this},minDate(t){return this._minDate=this._parseDate(t),this.update(),this.refresh(),this},getDate(){return this._currentDate.clone()},setDate(t){return this._currentDate=this._parseDate(t),this.update(),this.refresh(),this},update(){if(!this._currentDate)return this;this._minDate&&this._currentDate.isBefore(this._minDate)&&(this._currentDate=this._minDate.clone()),this._maxDate&&this._currentDate.isAfter(this._maxDate)&&(this._currentDate=this._maxDate.clone());const t=this._currentDate.format(this._settings.format);return a.setValue(this._node,t),this},viewDate(t){return this._viewDate=this._parseDate(t),this.refresh(),this}}),d.defaults={date:null,format:null,locale:DateFormatter.defaultLocale,timeZone:n.defaultTimeZone,minDate:null,maxDate:null,enabledDates:null,disabledDates:null,enabledDays:null,disabledDays:null,enabledHours:null,disabledHours:null,icons:{},buttons:{},keepOpen:!1,focusOnShow:!1,inline:!1,display:"dynamic",duration:100,placement:"bottom",position:"start",fixed:!1,spacing:3,minContact:!1},s&&(s.prototype.dateTimePicker=function(t,...a){let s,i;e.isObject(t)?s=t:e.isString(t)&&(i=t);for(const t of this){if(!e.isElement(t))continue;const n=d.init(t,s);i&&n[i](...a)}return this}),i.DateTimePicker=d}));